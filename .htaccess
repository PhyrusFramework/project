<IfModule mod_rewrite.c>
    RewriteEngine On

    RewriteBase /
    RewriteRule ^index\.php$ - [L]

    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteRule . /index.php [L]

    RewriteCond %{HTTP:Authorization} .
    RewriteRule .* - [E=HTTP_AUTHORIZATION:%{HTTP:Authorization}]
</IfModule>

# Apache 2.2
<IfModule !mod_authz_core.c>

    # Deny access to .htaccess
    <Files .htaccess>
    Order allow,deny
    Deny from all
    </Files>

    # Deny access to files with extensions .ini, .json, .log
    <FilesMatch "\.(json|ini|log)$">
        Order allow,deny
        Deny from all
    </FilesMatch>

    # Deny access to all PHP files except for index.php
    <Files *.php>
        Order Deny,Allow
        Deny from all
        Allow from 127.0.0.1
    </Files>

    <Files index.php>
        Order Allow,Deny
        Allow from all
    </Files>

</IfModule>

# Apache 2.4
<IfModule mod_authz_core.c>
    
    # Deny access to .htaccess
    <Files .htaccess>
    Require all denied
    </Files>

    # Deny access to files with extensions .ini, .json, .log
    <FilesMatch "\.(json|ini|log)$">
    Require all denied
    </FilesMatch>

    # Deny access to all PHP files except for index.php
    <FilesMatch \.(php)$>
        Require all denied
    </FilesMatch>

    <Files index.php>
        Require all granted
    </Files>

</IfModule>